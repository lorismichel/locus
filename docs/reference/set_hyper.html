<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Gather model hyperparameters provided by the user. — set_hyper • locus</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">locus</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Gather model hyperparameters provided by the user.</h1>
    </div>

    
    <p>This function must be used to provide hyperparameter values for the model
used in <code><a href='locus.html'>locus</a></code>.</p>
    

    <pre><span class='fu'>set_hyper</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='no'>lambda</span>, <span class='no'>nu</span>, <span class='no'>a</span>, <span class='no'>b</span>, <span class='no'>eta</span>, <span class='no'>kappa</span>, <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"identity"</span>,
  <span class='kw'>ind_bin</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>q</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>phi</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>xi</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>r</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>m0</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>d</th>
      <td><p>Number of responses.</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>Number of candidate predictors.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>Vector of length 1 providing the values of hyperparameter
\(\lambda\) for the prior distribution of \(\sigma^{-2}\). \(\sigma\)
represents the typical size of nonzero effects.</p></td>
    </tr>
    <tr>
      <th>nu</th>
      <td><p>Vector of length 1 providing the values of hyperparameter \(\nu\)
for the prior distribution of \(\sigma^{-2}\). \(\sigma\) represents
the typical size of nonzero effects.</p></td>
    </tr>
    <tr>
      <th>a</th>
      <td><p>Vector of length 1 or p providing the values of hyperparameter
\(a\) for the prior distributions for the proportion of responses
associated with each candidate predictor, \(\omega\) (vector of length p).
If of length 1, the provided value is repeated p times.</p></td>
    </tr>
    <tr>
      <th>b</th>
      <td><p>Vector of length 1 or p providing the values of hyperparameter
\(b\) for the prior distributions for the proportion of responses
associated with each candidate predictor, \(\omega\) (vector of length p).
If of length 1, the provided value is repeated p times.</p></td>
    </tr>
    <tr>
      <th>eta</th>
      <td><p>Vector of length 1 or d for <code>link = "identity"</code>, and of
length 1 or d_cont = d - length(ind_bin) (the number of continuous response
variables) for <code>link = "mix"</code>. Provides the values of
hyperparameter \(\eta\) for the prior distributions of the continuous
response residual precisions, \(\tau\). If of length 1, the provided
value is repeated d, resp. d_cont, times. Must be <code>NULL</code> for
<code>link = "logit"</code> and <code>link = "probit"</code>.</p></td>
    </tr>
    <tr>
      <th>kappa</th>
      <td><p>Vector of length 1 or d for <code>link = "identity"</code>, and of
length 1 or d_cont = d - length(ind_bin) (the number of continuous response
variables) for <code>link = "mix"</code>. Provides the values of hyperparameter
\(\kappa\) for the prior distributions of the response residual
precisions, \(\tau\). If of length 1, the provided value is repeated d,
resp. d_cont, times. Must be <code>NULL</code> for <code>link = "logit"</code> and
<code>link = "probit"</code>.</p></td>
    </tr>
    <tr>
      <th>link</th>
      <td><p>Response link. Must be "<code>identity</code>" for linear regression,
"<code>logit</code>" for logistic regression, "<code>probit</code>"
for probit regression, or "<code>mix</code>" for a mix of identity and probit
link functions (in this case, the indices of the binary responses must be
gathered in argument <code>ind_bin</code>, see below).</p></td>
    </tr>
    <tr>
      <th>ind_bin</th>
      <td><p>If <code>link = "mix"</code>, vector of indices corresponding to
the binary variables in <code>Y</code>. Must be <code>NULL</code> if
<code>link != "mix"</code>.</p></td>
    </tr>
    <tr>
      <th>q</th>
      <td><p>Number of covariates. Default is <code>NULL</code>, for <code>Z</code>
<code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>phi</th>
      <td><p>Vector of length 1 or q providing the values of hyperparameter
\(\phi\) for the prior distributions for the sizes of the nonzero
covariate effects, \(\zeta\). If of length 1, the provided value is
repeated q times. Default is <code>NULL</code>, for <code>Z</code> <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>xi</th>
      <td><p>Vector of length 1 or q providing the values of hyperparameter
\(\xi\) for the prior distributions for the sizes of the nonzero
covariate effects, \(\zeta\). If of length 1, the provided value is
repeated q times. Default is <code>NULL</code>, for <code>Z</code> <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>Number of variables representing external information on the
candidate predictors. Default is <code>NULL</code>, for <code>V</code> <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>m0</th>
      <td><p>Vector of length 1 or p providing the values of hyperparameter
\(m0\) for the prior distribution of \(c0\) linked to the proportion of
responses associated with each candidate predictor. If of length 1, the
provided value is repeated p times. Default is <code>NULL</code>, for <code>V</code>
<code>NULL</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class "<code>hyper</code>" preparing user hyperparameter in a
  form that can be passed to the <code><a href='locus.html'>locus</a></code> function.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code><a href='locus.html'>locus</a></code> function can also be used with default hyperparameter
choices (without using <code>set_hyper</code>) by setting its argument
<code>list_hyper</code> to <code>NULL</code>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='set_init.html'>set_init</a></code>, <code><a href='locus.html'>locus</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>user_seed</span> <span class='kw'>&lt;-</span> <span class='fl'>123</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>200</span>; <span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fl'>250</span>; <span class='no'>p0</span> <span class='kw'>&lt;-</span> <span class='fl'>50</span>; <span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fl'>25</span>; <span class='no'>d0</span> <span class='kw'>&lt;-</span> <span class='fl'>15</span>
<span class='no'>list_X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate_snps.html'>generate_snps</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='no'>n</span>, <span class='kw'>p</span> <span class='kw'>=</span> <span class='no'>p</span>, <span class='kw'>user_seed</span> <span class='kw'>=</span> <span class='no'>user_seed</span>)
<span class='no'>list_Y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate_phenos.html'>generate_phenos</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='no'>n</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='no'>d</span>, <span class='kw'>var_err</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>user_seed</span> <span class='kw'>=</span> <span class='no'>user_seed</span>)

<span class='co'># Continuous outcomes</span>
<span class='co'>#</span>
<span class='no'>dat_g</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate_dependence.html'>generate_dependence</a></span>(<span class='kw'>list_snps</span> <span class='kw'>=</span> <span class='no'>list_X</span>, <span class='kw'>list_phenos</span> <span class='kw'>=</span> <span class='no'>list_Y</span>,
                             <span class='kw'>ind_d0</span> <span class='kw'>=</span> <span class='fu'>sample</span>(<span class='fl'>1</span>:<span class='no'>d</span>, <span class='no'>d0</span>),
                             <span class='kw'>ind_p0</span> <span class='kw'>=</span> <span class='fu'>sample</span>(<span class='fl'>1</span>:<span class='no'>p</span>, <span class='no'>p0</span>), <span class='kw'>vec_prob_sh</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
                             <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"gaussian"</span>, <span class='kw'>max_tot_pve</span> <span class='kw'>=</span> <span class='fl'>0.9</span>,
                             <span class='kw'>user_seed</span> <span class='kw'>=</span> <span class='no'>user_seed</span>)

<span class='co'># a and b chosen so that the prior mean number of responses associated with</span>
<span class='co'># each candidate predictor is 1/4.</span>
<span class='no'>list_hyper_g</span> <span class='kw'>&lt;-</span> <span class='fu'>set_hyper</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>nu</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>a</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>b</span> <span class='kw'>=</span> <span class='fl'>4</span>*<span class='no'>d</span>-<span class='fl'>1</span>,
                          <span class='kw'>eta</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>kappa</span> <span class='kw'>=</span> <span class='fu'>apply</span>(<span class='no'>dat_g</span>$<span class='no'>phenos</span>, <span class='fl'>2</span>, <span class='no'>var</span>),
                          <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"identity"</span>)

<span class='co'># we take p0_av = p0 (known here); this choice may result in variable</span>
<span class='co'># selections that are (too) conservative in some cases. In practice, often</span>
<span class='co'># p0_av as a slightly overestimated guess of p0.</span>
<span class='no'>vb_g</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>dat_g</span>$<span class='no'>phenos</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_g</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0</span>,
              <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"identity"</span>, <span class='kw'>list_hyper</span> <span class='kw'>=</span> <span class='no'>list_hyper_g</span>,
              <span class='kw'>user_seed</span> <span class='kw'>=</span> <span class='no'>user_seed</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; Seed set to user_seed 123. 
#&gt; list_init set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -8960.294
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -7851.613
#&gt; 
#&gt; Convergence obtained after 10 iterations with variational lower bound = -7851.393. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
<span class='co'># Continuous outcomes with covariates</span>
<span class='co'>#</span>
<span class='no'>q</span> <span class='kw'>&lt;-</span> <span class='fl'>4</span>
<span class='no'>Z</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='no'>n</span> * <span class='no'>q</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>n</span>)

<span class='no'>list_hyper_g_z</span> <span class='kw'>&lt;-</span> <span class='fu'>set_hyper</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>nu</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>a</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>b</span> <span class='kw'>=</span> <span class='fl'>4</span>*<span class='no'>d</span>-<span class='fl'>1</span>,
                            <span class='kw'>eta</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>kappa</span> <span class='kw'>=</span> <span class='fu'>apply</span>(<span class='no'>dat_g</span>$<span class='no'>phenos</span>, <span class='fl'>2</span>, <span class='no'>var</span>),
                            <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"identity"</span>, <span class='kw'>q</span> <span class='kw'>=</span> <span class='no'>q</span>, <span class='kw'>phi</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>xi</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='no'>vb_g_z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>dat_g</span>$<span class='no'>phenos</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_g</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0</span>, <span class='kw'>Z</span> <span class='kw'>=</span> <span class='no'>Z</span>,
                <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"identity"</span>, <span class='kw'>list_hyper</span> <span class='kw'>=</span> <span class='no'>list_hyper_g_z</span>,
                <span class='kw'>user_seed</span> <span class='kw'>=</span> <span class='no'>user_seed</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; Each factor variables must be provided by adding to Z (nb levels - 1) variables representing their levels. 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; Seed set to user_seed 123. 
#&gt; list_init set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -12527.34
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -7988.895
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -7984.033
#&gt; 
#&gt; Convergence obtained after 12 iterations with variational lower bound = -7984.033. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
<span class='co'># Continuous outcomes with external annotation</span>
<span class='co'>#</span>
<span class='no'>r</span> <span class='kw'>&lt;-</span> <span class='fl'>4</span>
<span class='no'>V</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='no'>p</span> * <span class='no'>r</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>p</span>)
<span class='no'>bool_p0</span> <span class='kw'>&lt;-</span> <span class='fu'>rowSums</span>(<span class='no'>dat_g</span>$<span class='no'>pat</span>) <span class='kw'>&gt;</span> <span class='fl'>0</span>
<span class='no'>V</span>[<span class='no'>bool_p0</span>, ] <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='fu'>sum</span>(<span class='no'>bool_p0</span>) * <span class='no'>r</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>2</span>) <span class='co'># informative annotations</span>

<span class='no'>list_hyper_g_v</span> <span class='kw'>&lt;-</span> <span class='fu'>set_hyper</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>nu</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>a</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>b</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                            <span class='kw'>eta</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>kappa</span> <span class='kw'>=</span> <span class='fu'>apply</span>(<span class='no'>dat_g</span>$<span class='no'>phenos</span>, <span class='fl'>2</span>, <span class='no'>var</span>),
                            <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"identity"</span>, <span class='kw'>r</span> <span class='kw'>=</span> <span class='no'>r</span>, <span class='kw'>m0</span> <span class='kw'>=</span> <span class='fl'>0</span>)

<span class='no'>vb_g_v</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>dat_g</span>$<span class='no'>phenos</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_g</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0</span>,  <span class='kw'>V</span> <span class='kw'>=</span> <span class='no'>V</span>,
                <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"identity"</span>, <span class='kw'>list_hyper</span> <span class='kw'>=</span> <span class='no'>list_hyper_g_v</span>,
                <span class='kw'>user_seed</span> <span class='kw'>=</span> <span class='no'>user_seed</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; Seed set to user_seed 123. 
#&gt; list_init set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -19079.82
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -9371.355
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -8743.522
#&gt; 
#&gt; Iteration 15... 
#&gt; Lower bound = -8645.668
#&gt; 
#&gt; Iteration 20... 
#&gt; Lower bound = -8619.123
#&gt; 
#&gt; Iteration 25... 
#&gt; Lower bound = -8611.57
#&gt; 
#&gt; Iteration 30... 
#&gt; Lower bound = -8609.34
#&gt; 
#&gt; Iteration 35... 
#&gt; Lower bound = -8608.655
#&gt; 
#&gt; Iteration 40... 
#&gt; Lower bound = -8608.435
#&gt; 
#&gt; Iteration 45... 
#&gt; Lower bound = -8608.362
#&gt; 
#&gt; Iteration 50... 
#&gt; Lower bound = -8608.337
#&gt; 
#&gt; Iteration 55... 
#&gt; Lower bound = -8608.328
#&gt; 
#&gt; Iteration 60... 
#&gt; Lower bound = -8608.324
#&gt; 
#&gt; Iteration 65... 
#&gt; Lower bound = -8608.323
#&gt; 
#&gt; Convergence obtained after 69 iterations with variational lower bound = -8608.323. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
<span class='co'># Binary outcomes</span>
<span class='co'>#</span>
<span class='no'>dat_b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate_dependence.html'>generate_dependence</a></span>(<span class='kw'>list_snps</span> <span class='kw'>=</span> <span class='no'>list_X</span>, <span class='kw'>list_phenos</span> <span class='kw'>=</span> <span class='no'>list_Y</span>,
                             <span class='kw'>ind_d0</span> <span class='kw'>=</span> <span class='fu'>sample</span>(<span class='fl'>1</span>:<span class='no'>d</span>, <span class='no'>d0</span>),
                             <span class='kw'>ind_p0</span> <span class='kw'>=</span> <span class='fu'>sample</span>(<span class='fl'>1</span>:<span class='no'>p</span>, <span class='no'>p0</span>), <span class='kw'>vec_prob_sh</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
                             <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"binomial"</span>, <span class='kw'>max_tot_pve</span> <span class='kw'>=</span> <span class='fl'>0.9</span>,
                             <span class='kw'>user_seed</span> <span class='kw'>=</span> <span class='no'>user_seed</span>)

<span class='no'>list_hyper_logit</span> <span class='kw'>&lt;-</span> <span class='fu'>set_hyper</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>nu</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>a</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>b</span> <span class='kw'>=</span> <span class='fl'>4</span>*<span class='no'>d</span>-<span class='fl'>1</span>,
                              <span class='kw'>eta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>kappa</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                              <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"logit"</span>)

<span class='no'>vb_logit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>phenos</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0</span>,
                  <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"logit"</span>, <span class='kw'>list_hyper</span> <span class='kw'>=</span> <span class='no'>list_hyper_logit</span>,
                  <span class='kw'>user_seed</span> <span class='kw'>=</span> <span class='no'>user_seed</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; Seed set to user_seed 123. 
#&gt; list_init set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -12848.19
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -5233.802
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -4480.087
#&gt; 
#&gt; Iteration 15... 
#&gt; Lower bound = -4015.076
#&gt; 
#&gt; Iteration 20... 
#&gt; Lower bound = -3606.86
#&gt; 
#&gt; Iteration 25... 
#&gt; Lower bound = -3437.502
#&gt; 
#&gt; Iteration 30... 
#&gt; Lower bound = -3313.61
#&gt; 
#&gt; Iteration 35... 
#&gt; Lower bound = -3229.66
#&gt; 
#&gt; Iteration 40... 
#&gt; Lower bound = -3211.858
#&gt; 
#&gt; Iteration 45... 
#&gt; Lower bound = -3199.891
#&gt; 
#&gt; Iteration 50... 
#&gt; Lower bound = -3186.358
#&gt; 
#&gt; Iteration 55... 
#&gt; Lower bound = -3180.618
#&gt; 
#&gt; Iteration 60... 
#&gt; Lower bound = -3170.698
#&gt; 
#&gt; Iteration 65... 
#&gt; Lower bound = -3166.931
#&gt; 
#&gt; Iteration 70... 
#&gt; Lower bound = -3164.682
#&gt; 
#&gt; Iteration 75... 
#&gt; Lower bound = -3164.551
#&gt; 
#&gt; Iteration 80... 
#&gt; Lower bound = -3164.514
#&gt; 
#&gt; Iteration 85... 
#&gt; Lower bound = -3164.503
#&gt; 
#&gt; Iteration 90... 
#&gt; Lower bound = -3164.5
#&gt; 
#&gt; Iteration 95... 
#&gt; Lower bound = -3164.499
#&gt; 
#&gt; Convergence obtained after 98 iterations with variational lower bound = -3164.498. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
<span class='no'>list_hyper_probit</span> <span class='kw'>&lt;-</span> <span class='fu'>set_hyper</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>nu</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>a</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>b</span> <span class='kw'>=</span> <span class='fl'>4</span>*<span class='no'>d</span>-<span class='fl'>1</span>,
                               <span class='kw'>eta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>kappa</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                               <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"probit"</span>)

<span class='no'>vb_probit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>phenos</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0</span>,
                   <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"probit"</span>, <span class='kw'>list_hyper</span> <span class='kw'>=</span> <span class='no'>list_hyper_probit</span>,
                   <span class='kw'>user_seed</span> <span class='kw'>=</span> <span class='no'>user_seed</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; Seed set to user_seed 123. 
#&gt; list_init set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -3376.773
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -3274.148
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -3243.948
#&gt; 
#&gt; Iteration 15... 
#&gt; Lower bound = -3236.234
#&gt; 
#&gt; Iteration 20... 
#&gt; Lower bound = -3230.538
#&gt; 
#&gt; Iteration 25... 
#&gt; Lower bound = -3230.162
#&gt; 
#&gt; Iteration 30... 
#&gt; Lower bound = -3230.133
#&gt; 
#&gt; Iteration 35... 
#&gt; Lower bound = -3230.13
#&gt; 
#&gt; Convergence obtained after 38 iterations with variational lower bound = -3230.129. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
<span class='co'># Binary outcomes with covariates</span>
<span class='co'>#</span>
<span class='no'>list_hyper_logit_z</span> <span class='kw'>&lt;-</span> <span class='fu'>set_hyper</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>nu</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>a</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>b</span> <span class='kw'>=</span> <span class='fl'>4</span>*<span class='no'>d</span>-<span class='fl'>1</span>,
                                <span class='kw'>eta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>kappa</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                                <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"logit"</span>, <span class='kw'>q</span> <span class='kw'>=</span> <span class='no'>q</span>, <span class='kw'>phi</span> <span class='kw'>=</span> <span class='fl'>1</span>,
                                <span class='kw'>xi</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='no'>vb_logit_z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>phenos</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0</span>, <span class='kw'>Z</span> <span class='kw'>=</span> <span class='no'>Z</span>,
                    <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"logit"</span>,
                    <span class='kw'>list_hyper</span> <span class='kw'>=</span> <span class='no'>list_hyper_logit_z</span>, <span class='kw'>user_seed</span> <span class='kw'>=</span> <span class='no'>user_seed</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; Each factor variables must be provided by adding to Z (nb levels - 1) variables representing their levels. 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; Seed set to user_seed 123. 
#&gt; list_init set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -13359.45
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -5458.651
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -4742.715
#&gt; 
#&gt; Iteration 15... 
#&gt; Lower bound = -4259.575
#&gt; 
#&gt; Iteration 20... 
#&gt; Lower bound = -3897.018
#&gt; 
#&gt; Iteration 25... 
#&gt; Lower bound = -3660.42
#&gt; 
#&gt; Iteration 30... 
#&gt; Lower bound = -3520.332
#&gt; 
#&gt; Iteration 35... 
#&gt; Lower bound = -3445.843
#&gt; 
#&gt; Iteration 40... 
#&gt; Lower bound = -3358.993
#&gt; 
#&gt; Iteration 45... 
#&gt; Lower bound = -3283.276
#&gt; 
#&gt; Iteration 50... 
#&gt; Lower bound = -3259.899
#&gt; 
#&gt; Iteration 55... 
#&gt; Lower bound = -3253.353
#&gt; 
#&gt; Iteration 60... 
#&gt; Lower bound = -3247.442
#&gt; 
#&gt; Iteration 65... 
#&gt; Lower bound = -3240.225
#&gt; 
#&gt; Iteration 70... 
#&gt; Lower bound = -3237.613
#&gt; 
#&gt; Iteration 75... 
#&gt; Lower bound = -3236.367
#&gt; 
#&gt; Iteration 80... 
#&gt; Lower bound = -3236.231
#&gt; 
#&gt; Iteration 85... 
#&gt; Lower bound = -3234.095
#&gt; 
#&gt; Iteration 90... 
#&gt; Lower bound = -3234.05
#&gt; 
#&gt; Iteration 95... 
#&gt; Lower bound = -3233.911
#&gt; 
#&gt; Iteration 100... 
#&gt; Lower bound = -3233.363
#&gt; 
#&gt; Iteration 105... 
#&gt; Lower bound = -3233.361
#&gt; 
#&gt; Convergence obtained after 106 iterations with variational lower bound = -3233.361. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
<span class='no'>list_hyper_probit_z</span> <span class='kw'>&lt;-</span> <span class='fu'>set_hyper</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>nu</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>a</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>b</span> <span class='kw'>=</span> <span class='fl'>4</span>*<span class='no'>d</span>-<span class='fl'>1</span>,
                                 <span class='kw'>eta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>kappa</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                                 <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"probit"</span>, <span class='kw'>q</span> <span class='kw'>=</span> <span class='no'>q</span>, <span class='kw'>phi</span> <span class='kw'>=</span> <span class='fl'>1</span>,
                                 <span class='kw'>xi</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='no'>vb_probit_z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>phenos</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0</span>, <span class='kw'>Z</span> <span class='kw'>=</span> <span class='no'>Z</span>,
                     <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"probit"</span>,
                     <span class='kw'>list_hyper</span> <span class='kw'>=</span> <span class='no'>list_hyper_probit_z</span>, <span class='kw'>user_seed</span> <span class='kw'>=</span> <span class='no'>user_seed</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; Each factor variables must be provided by adding to Z (nb levels - 1) variables representing their levels. 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; Seed set to user_seed 123. 
#&gt; list_init set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -4801.484
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -3370.754
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -3356.969
#&gt; 
#&gt; Iteration 15... 
#&gt; Lower bound = -3352.259
#&gt; 
#&gt; Iteration 20... 
#&gt; Lower bound = -3351.955
#&gt; 
#&gt; Iteration 25... 
#&gt; Lower bound = -3351.934
#&gt; 
#&gt; Iteration 30... 
#&gt; Lower bound = -3351.93
#&gt; 
#&gt; Convergence obtained after 35 iterations with variational lower bound = -3351.929. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
<span class='co'># Mix of continuous and binary outcomes</span>
<span class='co'>#</span>
<span class='no'>Y_mix</span> <span class='kw'>&lt;-</span> <span class='fu'>cbind</span>(<span class='no'>dat_g</span>$<span class='no'>phenos</span>, <span class='no'>dat_b</span>$<span class='no'>phenos</span>)
<span class='no'>ind_bin</span> <span class='kw'>&lt;-</span> (<span class='no'>d</span>+<span class='fl'>1</span>):(<span class='fl'>2</span>*<span class='no'>d</span>)
<span class='no'>p0_mix</span> <span class='kw'>&lt;-</span> <span class='fu'>sum</span>(<span class='fu'>rowSums</span>(<span class='fu'>cbind</span>(<span class='no'>dat_g</span>$<span class='no'>pat</span>, <span class='no'>dat_b</span>$<span class='no'>pat</span>)) <span class='kw'>&gt;</span> <span class='fl'>0</span>)

<span class='no'>list_hyper_mix</span> <span class='kw'>&lt;-</span> <span class='fu'>set_hyper</span>(<span class='fl'>2</span>*<span class='no'>d</span>, <span class='no'>p</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>nu</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>a</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>b</span> <span class='kw'>=</span> <span class='fl'>8</span>*<span class='no'>d</span>-<span class='fl'>1</span>,
                            <span class='kw'>eta</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>kappa</span> <span class='kw'>=</span> <span class='fu'>apply</span>(<span class='no'>dat_g</span>$<span class='no'>phenos</span>, <span class='fl'>2</span>, <span class='no'>var</span>),
                            <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"mix"</span>, <span class='kw'>ind_bin</span> <span class='kw'>=</span> <span class='no'>ind_bin</span>)

<span class='no'>vb_mix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>Y_mix</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0_mix</span>, <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"mix"</span>,
                <span class='kw'>ind_bin</span> <span class='kw'>=</span> <span class='no'>ind_bin</span>, <span class='kw'>list_hyper</span> <span class='kw'>=</span> <span class='no'>list_hyper_mix</span>,
                <span class='kw'>user_seed</span> <span class='kw'>=</span> <span class='no'>user_seed</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; Seed set to user_seed 123. 
#&gt; list_init set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -13491.11
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -11170.93
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -11137.25
#&gt; 
#&gt; Iteration 15... 
#&gt; Lower bound = -11127.95
#&gt; 
#&gt; Iteration 20... 
#&gt; Lower bound = -11126.82
#&gt; 
#&gt; Iteration 25... 
#&gt; Lower bound = -11123.58
#&gt; 
#&gt; Iteration 30... 
#&gt; Lower bound = -11117.02
#&gt; 
#&gt; Iteration 35... 
#&gt; Lower bound = -11114.66
#&gt; 
#&gt; Iteration 40... 
#&gt; Lower bound = -11111.29
#&gt; 
#&gt; Iteration 45... 
#&gt; Lower bound = -11110.68
#&gt; 
#&gt; Iteration 50... 
#&gt; Lower bound = -11110.64
#&gt; 
#&gt; Iteration 55... 
#&gt; Lower bound = -11110.64
#&gt; 
#&gt; Iteration 60... 
#&gt; Lower bound = -11110.64
#&gt; 
#&gt; Convergence obtained after 65 iterations with variational lower bound = -11110.64. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
<span class='no'>list_hyper_mix_z</span> <span class='kw'>&lt;-</span> <span class='fu'>set_hyper</span>(<span class='fl'>2</span>*<span class='no'>d</span>, <span class='no'>p</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>nu</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>a</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>b</span> <span class='kw'>=</span> <span class='fl'>8</span>*<span class='no'>d</span>-<span class='fl'>1</span>,
                              <span class='kw'>eta</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>kappa</span> <span class='kw'>=</span> <span class='fu'>apply</span>(<span class='no'>dat_g</span>$<span class='no'>phenos</span>, <span class='fl'>2</span>, <span class='no'>var</span>),
                              <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"mix"</span>, <span class='kw'>ind_bin</span> <span class='kw'>=</span> <span class='no'>ind_bin</span>, <span class='kw'>q</span> <span class='kw'>=</span> <span class='no'>q</span>,
                              <span class='kw'>phi</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>xi</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='no'>vb_mix_z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>Y_mix</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0_mix</span>, <span class='kw'>Z</span> <span class='kw'>=</span> <span class='no'>Z</span>,
                  <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"mix"</span>, <span class='kw'>ind_bin</span> <span class='kw'>=</span> <span class='no'>ind_bin</span>,
                  <span class='kw'>list_hyper</span> <span class='kw'>=</span> <span class='no'>list_hyper_mix_z</span>, <span class='kw'>user_seed</span> <span class='kw'>=</span> <span class='no'>user_seed</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; Each factor variables must be provided by adding to Z (nb levels - 1) variables representing their levels. 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; Seed set to user_seed 123. 
#&gt; list_init set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -16608.99
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -11372.94
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -11352.12
#&gt; 
#&gt; Iteration 15... 
#&gt; Lower bound = -11339.49
#&gt; 
#&gt; Iteration 20... 
#&gt; Lower bound = -11336.35
#&gt; 
#&gt; Iteration 25... 
#&gt; Lower bound = -11327.61
#&gt; 
#&gt; Iteration 30... 
#&gt; Lower bound = -11326.77
#&gt; 
#&gt; Iteration 35... 
#&gt; Lower bound = -11326.68
#&gt; 
#&gt; Iteration 40... 
#&gt; Lower bound = -11326.67
#&gt; 
#&gt; Iteration 45... 
#&gt; Lower bound = -11326.67
#&gt; 
#&gt; Convergence obtained after 49 iterations with variational lower bound = -11326.67. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Helene Ruffieux.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
