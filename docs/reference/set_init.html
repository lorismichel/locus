<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Gather initial variational parameters provided by the user. — set_init • locus</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">locus</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Gather initial variational parameters provided by the user.</h1>
    </div>

    
    <p>This function must be used to provide initial values for the variational
parameters used in <code><a href='locus.html'>locus</a></code>.</p>
    

    <pre><span class='fu'>set_init</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='no'>gam_vb</span>, <span class='no'>mu_beta_vb</span>, <span class='no'>sig2_beta_vb</span>, <span class='no'>tau_vb</span>, <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"identity"</span>,
  <span class='kw'>ind_bin</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>q</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>mu_alpha_vb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>sig2_alpha_vb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>r</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>mu_c0_vb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>mu_c_vb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>d</th>
      <td><p>Number of responses.</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>Number of candidate predictors.</p></td>
    </tr>
    <tr>
      <th>gam_vb</th>
      <td><p>Matrix of size p x d with initial values for the variational
parameter yielding posterior probabilities of inclusion.</p></td>
    </tr>
    <tr>
      <th>mu_beta_vb</th>
      <td><p>Matrix of size p x d with initial values for the
variational parameter yielding regression coefficient estimates for
predictor-response pairs included in the model.</p></td>
    </tr>
    <tr>
      <th>sig2_beta_vb</th>
      <td><p>Vector of length d, for <code>link = "identity"</code> and
for <code>link = "mix"</code>, of length 1 for <code>link = "probit"</code>, and a
matrix of size p x d, for <code>link = "logit"</code>, with initial values for
the variational parameter yielding estimates of effect variances for
predictor-response pairs included in the model. For
<code>link = "identity"</code> and <code>link = "mix"</code>, these values are the same
for all the predictors (as a result of the predictor variables being
standardized before the variational algorithm). For <code>link = "probit"</code>,
they are the same for all the predictors and responses.</p></td>
    </tr>
    <tr>
      <th>tau_vb</th>
      <td><p>Vector of length d, for <code>link = "identity"</code>, and of
length d_cont = d - length(ind_bin) (number of continuous responses), for
<code>link = "mix"</code>, with initial values for the variational parameter
yielding estimates for the continuous response residual precisions. Must be
<code>NULL</code> for <code>link = "logit"</code> and <code>link = "probit"</code>.</p></td>
    </tr>
    <tr>
      <th>link</th>
      <td><p>Response link. Must be "<code>identity</code>" for linear regression,
"<code>logit</code>" for logistic regression, "<code>probit</code>" for probit
regression, or "<code>mix</code>" for a mix of identity and probit link functions
(in this case, the indices of the binary responses must be gathered in
argument <code>ind_bin</code>, see below).</p></td>
    </tr>
    <tr>
      <th>ind_bin</th>
      <td><p>If <code>link = "mix"</code>, vector of indices corresponding to the
binary variables in <code>Y</code>. Must be <code>NULL</code> if <code>link != "mix"</code>.</p></td>
    </tr>
    <tr>
      <th>q</th>
      <td><p>Number of covariates. Default is <code>NULL</code>, for <code>Z</code>
<code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>mu_alpha_vb</th>
      <td><p>Matrix of size q x d with initial values for the
variational parameter yielding regression coefficient estimates for
covariate-response pairs. Default is <code>NULL</code>, for <code>Z</code> <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>sig2_alpha_vb</th>
      <td><p>Matrix of size q x d for <code>link = "identity"</code>,
for <code>link = "logit"</code> and for <code>link = "mix"</code> with initial values
for the variational parameter yielding estimates of effect variances for
covariate-response pairs. Vector of length q for <code>link = "probit"</code>.
Default is <code>NULL</code>, for <code>Z</code> <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>Number of variables representing external information on the
candidate predictors. Default is <code>NULL</code>, for <code>V</code> <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>mu_c0_vb</th>
      <td><p>Vector of length p with initial values for the variational
parameter linked to the proportion of responses associated with each
candidate predictor. Default is <code>NULL</code>, for <code>V</code> <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>mu_c_vb</th>
      <td><p>Matrix of size r x d with initial values for the variational
parameter yielding regression coefficient estimates for the influence of
external information on the candidate predictors on their selection.
Default is <code>NULL</code>, for <code>V</code> <code>NULL</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class "<code>init</code>" preparing user initial values for
  the variational parameters in a form that can be passed to the
  <code><a href='locus.html'>locus</a></code> function.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code><a href='locus.html'>locus</a></code> function can also be used with default initial
parameter choices (without using <code>set_init</code>) by setting
its argument <code>list_init</code> to <code>NULL</code>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='set_hyper.html'>set_hyper</a></code>, <code><a href='locus.html'>locus</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>user_seed</span> <span class='kw'>&lt;-</span> <span class='fl'>123</span>; <span class='fu'>set.seed</span>(<span class='no'>user_seed</span>)
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>200</span>; <span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fl'>250</span>; <span class='no'>p0</span> <span class='kw'>&lt;-</span> <span class='fl'>50</span>; <span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fl'>25</span>; <span class='no'>d0</span> <span class='kw'>&lt;-</span> <span class='fl'>15</span>
<span class='no'>list_X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate_snps.html'>generate_snps</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='no'>n</span>, <span class='kw'>p</span> <span class='kw'>=</span> <span class='no'>p</span>)
<span class='no'>list_Y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate_phenos.html'>generate_phenos</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='no'>n</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='no'>d</span>, <span class='kw'>var_err</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='co'># Continuous outcomes</span>
<span class='co'>#</span>
<span class='no'>dat_g</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate_dependence.html'>generate_dependence</a></span>(<span class='kw'>list_snps</span> <span class='kw'>=</span> <span class='no'>list_X</span>, <span class='kw'>list_phenos</span> <span class='kw'>=</span> <span class='no'>list_Y</span>,
                             <span class='kw'>ind_d0</span> <span class='kw'>=</span> <span class='fu'>sample</span>(<span class='fl'>1</span>:<span class='no'>d</span>, <span class='no'>d0</span>),
                             <span class='kw'>ind_p0</span> <span class='kw'>=</span> <span class='fu'>sample</span>(<span class='fl'>1</span>:<span class='no'>p</span>, <span class='no'>p0</span>),
                             <span class='kw'>vec_prob_sh</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"gaussian"</span>,
                             <span class='kw'>max_tot_pve</span> <span class='kw'>=</span> <span class='fl'>0.9</span>)

<span class='co'># gam_vb chosen so that the prior mean number of responses associated with</span>
<span class='co'># each candidate predictor is 1/4.</span>
<span class='no'>gam_vb</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rbeta</span>(<span class='no'>p</span> * <span class='no'>d</span>, <span class='kw'>shape1</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>shape2</span> <span class='kw'>=</span> <span class='fl'>4</span>*<span class='no'>d</span>-<span class='fl'>1</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>p</span>)
<span class='no'>mu_beta_vb</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='no'>p</span> * <span class='no'>d</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>p</span>)
<span class='no'>tau_vb</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> / <span class='fu'>apply</span>(<span class='no'>dat_g</span>$<span class='no'>phenos</span>, <span class='fl'>2</span>, <span class='no'>var</span>)
<span class='no'>sig2_beta_vb</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> / <span class='fu'>rgamma</span>(<span class='no'>d</span>, <span class='kw'>shape</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>rate</span> <span class='kw'>=</span> <span class='fl'>1</span> / <span class='no'>tau_vb</span>)

<span class='no'>list_init_g</span> <span class='kw'>&lt;-</span> <span class='fu'>set_init</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='no'>gam_vb</span>, <span class='no'>mu_beta_vb</span>, <span class='no'>sig2_beta_vb</span>, <span class='no'>tau_vb</span>,
                        <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"identity"</span>)

<span class='no'>vb_g</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>dat_g</span>$<span class='no'>phenos</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_g</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0</span>,
              <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"identity"</span>, <span class='kw'>list_init</span> <span class='kw'>=</span> <span class='no'>list_init_g</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; list_hyper set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -8392.149
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -7732.243
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -7731.908
#&gt; 
#&gt; Convergence obtained after 12 iterations with variational lower bound = -7731.908. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
<span class='co'># Continuous outcomes with covariates</span>
<span class='co'>#</span>
<span class='no'>q</span> <span class='kw'>&lt;-</span> <span class='fl'>4</span>
<span class='no'>Z</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='no'>n</span> * <span class='no'>q</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>n</span>)

<span class='no'>mu_alpha_vb</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='no'>q</span> * <span class='no'>d</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>q</span>)
<span class='no'>sig2_alpha_vb</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> / <span class='fu'>matrix</span>(<span class='fu'>rgamma</span>(<span class='no'>q</span> * <span class='no'>d</span>, <span class='kw'>shape</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>rate</span> <span class='kw'>=</span> <span class='fl'>1</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>q</span>)

<span class='no'>list_init_g_z</span> <span class='kw'>&lt;-</span> <span class='fu'>set_init</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='no'>gam_vb</span>, <span class='no'>mu_beta_vb</span>, <span class='no'>sig2_beta_vb</span>, <span class='no'>tau_vb</span>,
                          <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"identity"</span>, <span class='kw'>q</span> <span class='kw'>=</span> <span class='no'>q</span>,
                          <span class='kw'>mu_alpha_vb</span> <span class='kw'>=</span> <span class='no'>mu_alpha_vb</span>,
                          <span class='kw'>sig2_alpha_vb</span> <span class='kw'>=</span> <span class='no'>sig2_alpha_vb</span>)

<span class='co'># we take p0_av = p0 (known here); this choice may result in variable</span>
<span class='co'># selections that are (too) conservative in some cases. In practice, often</span>
<span class='co'># p0_av as a slightly overestimated guess of p0.</span>
<span class='no'>vb_g_z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>dat_g</span>$<span class='no'>phenos</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_g</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0</span>, <span class='kw'>Z</span> <span class='kw'>=</span> <span class='no'>Z</span>,
                <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"identity"</span>, <span class='kw'>list_init</span> <span class='kw'>=</span> <span class='no'>list_init_g_z</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; Each factor variables must be provided by adding to Z (nb levels - 1) variables representing their levels. 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; list_hyper set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -9010.233
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -7864.928
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -7863.425
#&gt; 
#&gt; Convergence obtained after 13 iterations with variational lower bound = -7863.424. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
<span class='co'># Continuous outcomes with external annotation</span>
<span class='co'>#</span>
<span class='no'>r</span> <span class='kw'>&lt;-</span> <span class='fl'>4</span>
<span class='no'>V</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='no'>p</span> * <span class='no'>r</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>p</span>)
<span class='no'>bool_p0</span> <span class='kw'>&lt;-</span> <span class='fu'>rowSums</span>(<span class='no'>dat_g</span>$<span class='no'>pat</span>) <span class='kw'>&gt;</span> <span class='fl'>0</span>
<span class='no'>V</span>[<span class='no'>bool_p0</span>, ] <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='fu'>sum</span>(<span class='no'>bool_p0</span>) * <span class='no'>r</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>2</span>) <span class='co'># informative annotations</span>

<span class='no'>mu_c0_vb</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='no'>p</span>, <span class='kw'>mean</span> <span class='kw'>=</span> -<span class='fl'>1</span>)
<span class='no'>mu_c_vb</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='no'>r</span> * <span class='no'>d</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>0.01</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>r</span>)

<span class='no'>list_init_g_v</span> <span class='kw'>&lt;-</span> <span class='fu'>set_init</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='no'>gam_vb</span>, <span class='no'>mu_beta_vb</span>, <span class='no'>sig2_beta_vb</span>, <span class='no'>tau_vb</span>,
                          <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"identity"</span>, <span class='kw'>r</span> <span class='kw'>=</span> <span class='no'>r</span>, <span class='kw'>mu_c0_vb</span> <span class='kw'>=</span> <span class='no'>mu_c0_vb</span>,
                          <span class='kw'>mu_c_vb</span> <span class='kw'>=</span> <span class='no'>mu_c_vb</span>)

<span class='no'>vb_g_v</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>dat_g</span>$<span class='no'>phenos</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_g</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0</span>,  <span class='kw'>V</span> <span class='kw'>=</span> <span class='no'>V</span>,
                <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"identity"</span>, <span class='kw'>list_init</span> <span class='kw'>=</span> <span class='no'>list_init_g_v</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; list_hyper set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -22253.94
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -18051.88
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -15282.19
#&gt; 
#&gt; Iteration 15... 
#&gt; Lower bound = -13413.59
#&gt; 
#&gt; Iteration 20... 
#&gt; Lower bound = -12136.17
#&gt; 
#&gt; Iteration 25... 
#&gt; Lower bound = -11270.42
#&gt; 
#&gt; Iteration 30... 
#&gt; Lower bound = -10662.13
#&gt; 
#&gt; Iteration 35... 
#&gt; Lower bound = -10248.23
#&gt; 
#&gt; Iteration 40... 
#&gt; Lower bound = -9964.417
#&gt; 
#&gt; Iteration 45... 
#&gt; Lower bound = -9768.09
#&gt; 
#&gt; Iteration 50... 
#&gt; Lower bound = -9634.518
#&gt; 
#&gt; Iteration 55... 
#&gt; Lower bound = -9544.132
#&gt; 
#&gt; Iteration 60... 
#&gt; Lower bound = -9481.631
#&gt; 
#&gt; Iteration 65... 
#&gt; Lower bound = -9439.442
#&gt; 
#&gt; Iteration 70... 
#&gt; Lower bound = -9411.242
#&gt; 
#&gt; Iteration 75... 
#&gt; Lower bound = -9392.295
#&gt; 
#&gt; Iteration 80... 
#&gt; Lower bound = -9379.538
#&gt; 
#&gt; Iteration 85... 
#&gt; Lower bound = -9370.94
#&gt; 
#&gt; Iteration 90... 
#&gt; Lower bound = -9365.14
#&gt; 
#&gt; Iteration 95... 
#&gt; Lower bound = -9361.224
#&gt; 
#&gt; Iteration 100... 
#&gt; Lower bound = -9358.571
#&gt; 
#&gt; Iteration 105... 
#&gt; Lower bound = -9356.651
#&gt; 
#&gt; Iteration 110... 
#&gt; Lower bound = -9336.916
#&gt; 
#&gt; Iteration 115... 
#&gt; Lower bound = -9320.643
#&gt; 
#&gt; Iteration 120... 
#&gt; Lower bound = -9312.615
#&gt; 
#&gt; Iteration 125... 
#&gt; Lower bound = -9307.823
#&gt; 
#&gt; Iteration 130... 
#&gt; Lower bound = -9304.777
#&gt; 
#&gt; Iteration 135... 
#&gt; Lower bound = -9302.798
#&gt; 
#&gt; Iteration 140... 
#&gt; Lower bound = -9301.497
#&gt; 
#&gt; Iteration 145... 
#&gt; Lower bound = -9300.635
#&gt; 
#&gt; Iteration 150... 
#&gt; Lower bound = -9300.06
#&gt; 
#&gt; Iteration 155... 
#&gt; Lower bound = -9299.675
#&gt; 
#&gt; Iteration 160... 
#&gt; Lower bound = -9299.416
#&gt; 
#&gt; Iteration 165... 
#&gt; Lower bound = -9299.24
#&gt; 
#&gt; Iteration 170... 
#&gt; Lower bound = -9299.113
#&gt; 
#&gt; Iteration 175... 
#&gt; Lower bound = -9298.742
#&gt; 
#&gt; Iteration 180... 
#&gt; Lower bound = -9293.966
#&gt; 
#&gt; Iteration 185... 
#&gt; Lower bound = -9290.697
#&gt; 
#&gt; Iteration 190... 
#&gt; Lower bound = -9288.476
#&gt; 
#&gt; Iteration 195... 
#&gt; Lower bound = -9286.367
#&gt; 
#&gt; Iteration 200... 
#&gt; Lower bound = -9275.842
#&gt; 
#&gt; Iteration 205... 
#&gt; Lower bound = -9259.815
#&gt; 
#&gt; Iteration 210... 
#&gt; Lower bound = -9251.461
#&gt; 
#&gt; Iteration 215... 
#&gt; Lower bound = -9245.98
#&gt; 
#&gt; Iteration 220... 
#&gt; Lower bound = -9242.297
#&gt; 
#&gt; Iteration 225... 
#&gt; Lower bound = -9239.814
#&gt; 
#&gt; Iteration 230... 
#&gt; Lower bound = -9238.138
#&gt; 
#&gt; Iteration 235... 
#&gt; Lower bound = -9237.007
#&gt; 
#&gt; Iteration 240... 
#&gt; Lower bound = -9236.243
#&gt; 
#&gt; Iteration 245... 
#&gt; Lower bound = -9235.727
#&gt; 
#&gt; Iteration 250... 
#&gt; Lower bound = -9235.379
#&gt; 
#&gt; Iteration 255... 
#&gt; Lower bound = -9235.143
#&gt; 
#&gt; Iteration 260... 
#&gt; Lower bound = -9234.984
#&gt; 
#&gt; Iteration 265... 
#&gt; Lower bound = -9234.877
#&gt; 
#&gt; Iteration 270... 
#&gt; Lower bound = -9234.804
#&gt; 
#&gt; Iteration 275... 
#&gt; Lower bound = -9234.755
#&gt; 
#&gt; Iteration 280... 
#&gt; Lower bound = -9234.722
#&gt; 
#&gt; Iteration 285... 
#&gt; Lower bound = -9234.7
#&gt; 
#&gt; Iteration 290... 
#&gt; Lower bound = -9234.685
#&gt; 
#&gt; Iteration 295... 
#&gt; Lower bound = -9234.675
#&gt; 
#&gt; Iteration 300... 
#&gt; Lower bound = -9234.668
#&gt; 
#&gt; Iteration 305... 
#&gt; Lower bound = -9234.663
#&gt; 
#&gt; Iteration 310... 
#&gt; Lower bound = -9234.66
#&gt; 
#&gt; Iteration 315... 
#&gt; Lower bound = -9234.658
#&gt; 
#&gt; Iteration 320... 
#&gt; Lower bound = -9234.656
#&gt; 
#&gt; Iteration 325... 
#&gt; Lower bound = -9234.655
#&gt; 
#&gt; Iteration 330... 
#&gt; Lower bound = -9234.655
#&gt; 
#&gt; Convergence obtained after 333 iterations with variational lower bound = -9234.654. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
<span class='co'># Binary outcomes</span>
<span class='co'>#</span>
<span class='no'>dat_b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate_dependence.html'>generate_dependence</a></span>(<span class='kw'>list_snps</span> <span class='kw'>=</span> <span class='no'>list_X</span>, <span class='kw'>list_phenos</span> <span class='kw'>=</span> <span class='no'>list_Y</span>,
                             <span class='kw'>ind_d0</span> <span class='kw'>=</span> <span class='fu'>sample</span>(<span class='fl'>1</span>:<span class='no'>d</span>, <span class='no'>d0</span>),
                             <span class='kw'>ind_p0</span> <span class='kw'>=</span> <span class='fu'>sample</span>(<span class='fl'>1</span>:<span class='no'>p</span>, <span class='no'>p0</span>),
                             <span class='kw'>vec_prob_sh</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"binomial"</span>,
                             <span class='kw'>max_tot_pve</span> <span class='kw'>=</span> <span class='fl'>0.9</span>)

<span class='co'># gam_vb chosen so that the prior mean number of responses associated with</span>
<span class='co'># each candidate predictor is 1/4.</span>
<span class='no'>sig2_beta_vb_logit</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> / <span class='fu'>t</span>(<span class='fu'>replicate</span>(<span class='no'>p</span>, <span class='fu'>rgamma</span>(<span class='no'>d</span>, <span class='kw'>shape</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>rate</span> <span class='kw'>=</span> <span class='fl'>1</span>)))

<span class='no'>list_init_logit</span> <span class='kw'>&lt;-</span> <span class='fu'>set_init</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='no'>gam_vb</span>, <span class='no'>mu_beta_vb</span>, <span class='no'>sig2_beta_vb_logit</span>,
                            <span class='kw'>tau_vb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"logit"</span>)

<span class='no'>vb_logit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>phenos</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0</span>,
                  <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"logit"</span>, <span class='kw'>list_init</span> <span class='kw'>=</span> <span class='no'>list_init_logit</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; list_hyper set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -3408.328
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -3091.242
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -3088.856
#&gt; 
#&gt; Iteration 15... 
#&gt; Lower bound = -3088.021
#&gt; 
#&gt; Iteration 20... 
#&gt; Lower bound = -3087.633
#&gt; 
#&gt; Iteration 25... 
#&gt; Lower bound = -3087.617
#&gt; 
#&gt; Convergence obtained after 30 iterations with variational lower bound = -3087.616. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>

<span class='no'>sig2_beta_vb_probit</span> <span class='kw'>&lt;-</span> <span class='no'>sig2_beta_vb</span>[<span class='fl'>1</span>]
<span class='no'>list_init_probit</span> <span class='kw'>&lt;-</span> <span class='fu'>set_init</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='no'>gam_vb</span>, <span class='no'>mu_beta_vb</span>, <span class='no'>sig2_beta_vb_probit</span>,
                             <span class='kw'>tau_vb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"probit"</span>)

<span class='no'>vb_probit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>phenos</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0</span>,
                   <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"probit"</span>, <span class='kw'>list_init</span> <span class='kw'>=</span> <span class='no'>list_init_probit</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; list_hyper set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -3270.045
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -3141.964
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -3129.708
#&gt; 
#&gt; Iteration 15... 
#&gt; Lower bound = -3128.187
#&gt; 
#&gt; Iteration 20... 
#&gt; Lower bound = -3128.163
#&gt; 
#&gt; Iteration 25... 
#&gt; Lower bound = -3128.162
#&gt; 
#&gt; Convergence obtained after 26 iterations with variational lower bound = -3128.162. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
<span class='co'># Binary outcomes with covariates</span>
<span class='co'>#</span>
<span class='no'>list_init_logit_z</span> <span class='kw'>&lt;-</span> <span class='fu'>set_init</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='no'>gam_vb</span>, <span class='no'>mu_beta_vb</span>, <span class='no'>sig2_beta_vb_logit</span>,
                              <span class='kw'>tau_vb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"logit"</span>,
                              <span class='kw'>q</span> <span class='kw'>=</span> <span class='no'>q</span>, <span class='kw'>mu_alpha_vb</span> <span class='kw'>=</span> <span class='no'>mu_alpha_vb</span>,
                              <span class='kw'>sig2_alpha_vb</span> <span class='kw'>=</span> <span class='no'>sig2_alpha_vb</span>)

<span class='no'>vb_logit_z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>phenos</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0</span>, <span class='kw'>Z</span> <span class='kw'>=</span> <span class='no'>Z</span>,
                   <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"logit"</span>, <span class='kw'>list_init</span> <span class='kw'>=</span> <span class='no'>list_init_logit_z</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; Each factor variables must be provided by adding to Z (nb levels - 1) variables representing their levels. 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; list_hyper set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -4201.992
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -3169.318
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -3167.883
#&gt; 
#&gt; Iteration 15... 
#&gt; Lower bound = -3167.778
#&gt; 
#&gt; Iteration 20... 
#&gt; Lower bound = -3167.729
#&gt; 
#&gt; Convergence obtained after 24 iterations with variational lower bound = -3167.729. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
<span class='no'>sig2_alpha_vb_probit</span> <span class='kw'>&lt;-</span> <span class='no'>sig2_alpha_vb</span>[, <span class='fl'>1</span>]
<span class='no'>list_init_probit_z</span> <span class='kw'>&lt;-</span> <span class='fu'>set_init</span>(<span class='no'>d</span>, <span class='no'>p</span>, <span class='no'>gam_vb</span>, <span class='no'>mu_beta_vb</span>, <span class='no'>sig2_beta_vb_probit</span>,
                               <span class='kw'>tau_vb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"probit"</span>,
                               <span class='kw'>q</span> <span class='kw'>=</span> <span class='no'>q</span>, <span class='kw'>mu_alpha_vb</span> <span class='kw'>=</span> <span class='no'>mu_alpha_vb</span>,
                               <span class='kw'>sig2_alpha_vb</span> <span class='kw'>=</span> <span class='no'>sig2_alpha_vb_probit</span>)

<span class='no'>vb_probit_z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>phenos</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0</span>, <span class='kw'>Z</span> <span class='kw'>=</span> <span class='no'>Z</span>,
                     <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"probit"</span>, <span class='kw'>list_init</span> <span class='kw'>=</span> <span class='no'>list_init_probit_z</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; Each factor variables must be provided by adding to Z (nb levels - 1) variables representing their levels. 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; list_hyper set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -4474.302
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -3283.438
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -3271.126
#&gt; 
#&gt; Iteration 15... 
#&gt; Lower bound = -3270.917
#&gt; 
#&gt; Iteration 20... 
#&gt; Lower bound = -3268.928
#&gt; 
#&gt; Iteration 25... 
#&gt; Lower bound = -3268.884
#&gt; 
#&gt; Convergence obtained after 28 iterations with variational lower bound = -3268.884. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
<span class='co'># Mix of continuous and binary outcomes</span>
<span class='co'>#</span>
<span class='no'>Y_mix</span> <span class='kw'>&lt;-</span> <span class='fu'>cbind</span>(<span class='no'>dat_g</span>$<span class='no'>phenos</span>, <span class='no'>dat_b</span>$<span class='no'>phenos</span>)
<span class='no'>ind_bin</span> <span class='kw'>&lt;-</span> (<span class='no'>d</span>+<span class='fl'>1</span>):(<span class='fl'>2</span>*<span class='no'>d</span>)
<span class='no'>p0_mix</span> <span class='kw'>&lt;-</span> <span class='fu'>sum</span>(<span class='fu'>rowSums</span>(<span class='fu'>cbind</span>(<span class='no'>dat_g</span>$<span class='no'>pat</span>, <span class='no'>dat_b</span>$<span class='no'>pat</span>)) <span class='kw'>&gt;</span> <span class='fl'>0</span>)


<span class='co'># gam_vb chosen so that the prior mean number of responses associated with</span>
<span class='co'># each candidate predictor is 1/4.</span>
<span class='no'>gam_vb_mix</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rbeta</span>(<span class='no'>p</span> * <span class='fl'>2</span>*<span class='no'>d</span>, <span class='kw'>shape1</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>shape2</span> <span class='kw'>=</span> <span class='fl'>8</span>*<span class='no'>d</span>-<span class='fl'>1</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>p</span>)
<span class='no'>mu_beta_vb_mix</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='no'>p</span> * <span class='fl'>2</span>*<span class='no'>d</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>p</span>)
<span class='no'>sig2_beta_vb_mix</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> / <span class='fu'>c</span>(<span class='fu'>rgamma</span>(<span class='no'>d</span>, <span class='kw'>shape</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>rate</span> <span class='kw'>=</span> <span class='fl'>1</span> / <span class='no'>tau_vb</span>),
                          <span class='fu'>rgamma</span>(<span class='no'>d</span>, <span class='kw'>shape</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>rate</span> <span class='kw'>=</span> <span class='fl'>1</span>))


<span class='no'>list_init_mix</span> <span class='kw'>&lt;-</span> <span class='fu'>set_init</span>(<span class='fl'>2</span>*<span class='no'>d</span>, <span class='no'>p</span>, <span class='no'>gam_vb_mix</span>, <span class='no'>mu_beta_vb_mix</span>,
                          <span class='no'>sig2_beta_vb_mix</span>, <span class='no'>tau_vb</span>, <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"mix"</span>,
                          <span class='kw'>ind_bin</span> <span class='kw'>=</span> <span class='no'>ind_bin</span>)

<span class='no'>vb_mix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>Y_mix</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0_mix</span>, <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"mix"</span>,
                <span class='kw'>ind_bin</span> <span class='kw'>=</span> <span class='no'>ind_bin</span>, <span class='kw'>list_init</span> <span class='kw'>=</span> <span class='no'>list_init_mix</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 89 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; list_hyper set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -11689.61
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -10911.23
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -10900.25
#&gt; 
#&gt; Iteration 15... 
#&gt; Lower bound = -10898.35
#&gt; 
#&gt; Iteration 20... 
#&gt; Lower bound = -10898.33
#&gt; 
#&gt; Convergence obtained after 24 iterations with variational lower bound = -10898.33. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
<span class='no'>mu_alpha_vb_mix</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='no'>q</span> * <span class='fl'>2</span>*<span class='no'>d</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>q</span>)
<span class='no'>sig2_alpha_vb_mix</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> / <span class='fu'>matrix</span>(<span class='fu'>rgamma</span>(<span class='no'>q</span> * <span class='fl'>2</span>*<span class='no'>d</span>, <span class='kw'>shape</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>rate</span> <span class='kw'>=</span> <span class='fl'>1</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>q</span>)

<span class='no'>list_init_mix_z</span> <span class='kw'>&lt;-</span> <span class='fu'>set_init</span>(<span class='fl'>2</span>*<span class='no'>d</span>, <span class='no'>p</span>, <span class='no'>gam_vb_mix</span>, <span class='no'>mu_beta_vb_mix</span>,
                            <span class='no'>sig2_beta_vb_mix</span>, <span class='no'>tau_vb</span>, <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"mix"</span>,
                            <span class='kw'>ind_bin</span> <span class='kw'>=</span> <span class='no'>ind_bin</span>, <span class='kw'>q</span> <span class='kw'>=</span> <span class='no'>q</span>,
                            <span class='kw'>mu_alpha_vb</span> <span class='kw'>=</span> <span class='no'>mu_alpha_vb_mix</span>,
                            <span class='kw'>sig2_alpha_vb</span> <span class='kw'>=</span> <span class='no'>sig2_alpha_vb_mix</span>)

<span class='no'>vb_mix_z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>Y_mix</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat_b</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0_mix</span>, <span class='kw'>Z</span> <span class='kw'>=</span> <span class='no'>Z</span>,
                  <span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"mix"</span>, <span class='kw'>ind_bin</span> <span class='kw'>=</span> <span class='no'>ind_bin</span>,
                  <span class='kw'>list_init</span> <span class='kw'>=</span> <span class='no'>list_init_mix_z</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; Each factor variables must be provided by adding to Z (nb levels - 1) variables representing their levels. 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 89 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; list_hyper set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -13583.81
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -11152.01
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -11116.51
#&gt; 
#&gt; Iteration 15... 
#&gt; Lower bound = -11112.56
#&gt; 
#&gt; Iteration 20... 
#&gt; Lower bound = -11110.39
#&gt; 
#&gt; Iteration 25... 
#&gt; Lower bound = -11110.38
#&gt; 
#&gt; Iteration 30... 
#&gt; Lower bound = -11110.38
#&gt; 
#&gt; Convergence obtained after 32 iterations with variational lower bound = -11110.38. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Helene Ruffieux.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
