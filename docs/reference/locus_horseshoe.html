<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit a sparse multivariate regression model using variational inference. — locus_horseshoe • locus</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">locus</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a sparse multivariate regression model using variational inference.</h1>
    </div>

    
    <p>Variational approximation procedure fitting a sparse multivariate regression
model for combined selection of predictors and associated responses in
high-dimensional set-ups. Dependence across responses linked to the same
predictors is captured through the model hierarchical structure.</p>
    

    <pre><span class='fu'>locus_horseshoe</span>(<span class='no'>Y</span>, <span class='no'>X</span>, <span class='no'>p0_av</span>, <span class='kw'>Z</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>list_hyper</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>list_init</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>list_cv</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>list_blocks</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>user_seed</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>1e-04</span>, <span class='kw'>maxit</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>batch</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>save_hyper</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>save_init</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Y</th>
      <td><p>Continuous response data matrix of dimension n x d, where n is the
number of observations and d is the number of response variables.</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>Input matrix of dimension n x p, where p is the number of candidate
predictors. <code>X</code> cannot contain NAs. No intercept must be supplied.</p></td>
    </tr>
    <tr>
      <th>Z</th>
      <td><p>Covariate matrix of dimension n x q, where q is the number of
covariates. <code>NULL</code> if no covariate. Factor covariates must be supplied
after transformation to dummy coding. No intercept must be supplied.</p></td>
    </tr>
    <tr>
      <th>list_hyper</th>
      <td><p>An object of class "<code>hyper</code>" containing the model
hyperparameters. Must be filled using the <code><a href='set_hyper.html'>set_hyper</a></code>
function or must be <code>NULL</code> for default hyperparameters.</p></td>
    </tr>
    <tr>
      <th>list_init</th>
      <td><p>An object of class "<code>init</code>" containing the initial
variational parameters. Must be filled using the
<code><a href='set_init.html'>set_init</a></code> function or be <code>NULL</code> for a default
initialization.</p></td>
    </tr>
    <tr>
      <th>list_cv</th>
      <td><p>An object of class "<code>cv</code>" containing settings for
choosing the prior average number of predictors expected to be included in
the model, <code>p0_av</code>, by cross-validation. Must be filled using the
<code><a href='set_cv.html'>set_cv</a></code> function or must be <code>NULL</code> for no
cross-validation. If non-<code>NULL</code>, <code>p0_av</code>, <code>list_init</code> and
<code>list_hyper</code> must all be <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>list_blocks</th>
      <td><p>An object of class "<code>blocks</code>" containing setting for
parallel inference on a partitioned predictor space. Must be filled using
the <code><a href='set_blocks.html'>set_blocks</a></code> function or must be <code>NULL</code> for no
partitioning.</p></td>
    </tr>
    <tr>
      <th>user_seed</th>
      <td><p>Seed set for reproducible default choices of hyperparameters
(if <code>list_hyper</code> is <code>NULL</code>) and inital variational parameters (if
<code>list_init</code> is <code>NULL</code>). Also used at the cross-validation stage
(if <code>list_cv</code> is non-<code>NULL</code>). Default is <code>NULL</code>, no seed set.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Tolerance for the stopping criterion.</p></td>
    </tr>
    <tr>
      <th>maxit</th>
      <td><p>Maximum number of iterations allowed.</p></td>
    </tr>
    <tr>
      <th>batch</th>
      <td><p>If <code>TRUE</code> a fast batch updating scheme is used
(recommended).</p></td>
    </tr>
    <tr>
      <th>save_hyper</th>
      <td><p>If <code>TRUE</code>, the hyperparameters used for the model are
saved as output.</p></td>
    </tr>
    <tr>
      <th>save_init</th>
      <td><p>If <code>TRUE</code>, the initial variational parameters used for
the inference are saved as output.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>If <code>TRUE</code>, messages are displayed during execution.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class "<code>vb</code>" containing the following variational
  estimates and settings:</p>
<dt>lb_opt</dt><dd><p>Optimized variational lower bound for the marginal
               log-likelihood.</p></dd>
 <dt>gam_vb</dt><dd><p>Posterior inclusion probability matrix of dimension p x d.
               Entry (s, t) corresponds to the posterior probability of
               association between predictor s and response t.</p></dd>
 <dt>mu_alpha_vb</dt><dd><p>Matrix of dimension q x d whose entries are the posterior
                    mean regression coefficients for the covariates provided
                    in <code>Z</code>. <code>NULL</code> if <code>Z</code> is <code>NULL</code>.</p></dd>
 <dt>om_vb</dt><dd><p>Vector of size p containing the posterior mean of omega. Entry
             s controls the proportion of responses associated with predictor
             s.</p></dd>
 <dt>x_prpnst</dt><dd><p>Vector of size p containing the sums over the colums of
                 <code>gam_vb</code>, used to evaluate the propensity for the
                 candidate predictors to be involved in associations.</p></dd>
 <dt>y_prpnst</dt><dd><p>Vector of size d containing the sums over the rows of
                 <code>gam_vb</code>, used to evaluate the propensity for the
                 responses to be involved in associations.</p></dd>
 <dt>rmvd_cst_x, rmvd_cst_z</dt><dd><p>Vectors containing the indices of constant
                               variables in X (resp. Z) removed prior to the
                               analysis.</p></dd>
 <dt>rmvd_coll_x, rmvd_coll_z</dt><dd><p>Vectors containing the indices of variables
                                 in X (resp. Z) removed prior to the
                                 analysis because collinear to other
                                 variables. The entry name indicates the
                                 corresponding variable kept in the analysis
                                 (i.e., that causing the collinearity for the
                                 entry in question).</p></dd>
 <dt>list_hyper, list_init</dt><dd><p>If <code>save_hyper</code>, resp. <code>save_init</code>,
                              <code>TRUE</code>, hyperparameters, resp. initial
                              variational parameters, used for inference are
                              saved as output.</p></dd>

    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='set_hyper.html'>set_hyper</a></code>, <code><a href='set_init.html'>set_init</a></code>,
  <code><a href='set_cv.html'>set_cv</a></code>, <code><a href='set_blocks.html'>set_blocks</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>user_seed</span> <span class='kw'>&lt;-</span> <span class='fl'>123</span>; <span class='fu'>set.seed</span>(<span class='no'>user_seed</span>)
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>200</span>; <span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fl'>300</span>; <span class='no'>p0</span> <span class='kw'>&lt;-</span> <span class='fl'>50</span>; <span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fl'>40</span>; <span class='no'>d0</span> <span class='kw'>&lt;-</span> <span class='fl'>30</span>
<span class='no'>list_X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate_snps.html'>generate_snps</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='no'>n</span>, <span class='kw'>p</span> <span class='kw'>=</span> <span class='no'>p</span>)
<span class='no'>list_Y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate_phenos.html'>generate_phenos</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='no'>n</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='no'>d</span>, <span class='kw'>var_err</span> <span class='kw'>=</span> <span class='fl'>0.25</span>)

<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate_dependence.html'>generate_dependence</a></span>(<span class='kw'>list_snps</span> <span class='kw'>=</span> <span class='no'>list_X</span>, <span class='kw'>list_phenos</span> <span class='kw'>=</span> <span class='no'>list_Y</span>,
                           <span class='kw'>ind_d0</span> <span class='kw'>=</span> <span class='fu'>sample</span>(<span class='fl'>1</span>:<span class='no'>d</span>, <span class='no'>d0</span>), <span class='kw'>ind_p0</span> <span class='kw'>=</span> <span class='fu'>sample</span>(<span class='fl'>1</span>:<span class='no'>p</span>, <span class='no'>p0</span>),
                           <span class='kw'>vec_prob_sh</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>max_tot_pve</span> <span class='kw'>=</span> <span class='fl'>0.9</span>)

<span class='no'>vb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='locus.html'>locus</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>dat</span>$<span class='no'>phenos</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dat</span>$<span class='no'>snps</span>, <span class='kw'>p0_av</span> <span class='kw'>=</span> <span class='no'>p0</span>, <span class='kw'>user_seed</span> <span class='kw'>=</span> <span class='no'>user_seed</span>)</div><div class='output co'>#&gt; == Preparing the data ... 
#&gt; ... done. == 
#&gt; 
#&gt; Provided p0_av = 50 interpreted as the prior number of predictors associated with at least one response. 
#&gt; 
#&gt; == Preparing the hyperparameters ... 
#&gt; 
#&gt; list_hyper set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; == Preparing the parameter initialization ... 
#&gt; 
#&gt; Seed set to user_seed 123. 
#&gt; list_init set automatically. 
#&gt; ... done. == 
#&gt; 
#&gt; ============================================================== 
#&gt; == Variational inference for sparse multivariate regression == 
#&gt; ============================================================== 
#&gt; 
#&gt; Iteration 1... 
#&gt; Lower bound = -7791.264
#&gt; 
#&gt; Iteration 5... 
#&gt; Lower bound = -6738.198
#&gt; 
#&gt; Iteration 10... 
#&gt; Lower bound = -6736.132
#&gt; 
#&gt; Convergence obtained after 14 iterations with variational lower bound = -6736.127. 
#&gt; 
#&gt; ... done. == 
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Helene Ruffieux.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
